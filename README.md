# Monte-Carlo RT Model of Astrophysical Cocoons

The Neupert effect is an empirical law describing the temporal relationship between non-thermal and thermal radiation in solar flares. It states that the light curve of thermal radiation is proportional to the time integral of the non-thermal radiation. This study investigates whether this effect still holds in the cocoon plasma medium surrounding high-energy celestial objects. We developed a 2D Monte Carlo radiation transfer (MCRT) model to simulate flare light curves within a ring-shaped cocoon structure. The model tracks photon motion, absorption, energy storage, and re-emission thermal processes inside the cocoon, simultaneously generating non-thermal and thermal light curves. 

We simulated typical impulsive and gradual (long-duration) flares, and the results indicate that the validity of the Neupert effect strongly depends on the physical conditions of the cocoon. When the cooling timescale is long, the derivative of the thermal light curve closely matches the non-thermal light curve, confirming the Neupert effect. However, cooling effects can disrupt this correlation and even cause the derivative of the thermal light curve to become negative after the peak. Additionally, if thermal photon re-emission is considered as isotropic scattering, the prolonged photon paths result in a trailing effect, which also violates the Neupert effect.

We successfully applied the model to a real solar flare case, reproducing the observed light curves through parameter adjustments. This demonstrates that the simulation can be used to infer the physical properties of the flare source region and its surrounding environment. Our study concludes that the cooling timescale and geometric configuration of the cocoon are key factors determining the validity of the Neupert effect. In the future, this numerical framework can be extended to 3D cocoon structures or incorporate more complex radiation transfer processes.
